---
phase: 03-init-flow
plan: 03
type: execute
wave: 2
depends_on: ["03-02"]
files_modified:
  - client/src/components/review/ReviewSection.tsx
  - client/src/components/review/ReviewPage.tsx
  - client/src/components/review/index.ts
autonomous: true

must_haves:
  truths:
    - "User can see all entered KYC data organized by section"
    - "Each section has an Edit button that allows returning to that step"
    - "Quote summary sidebar shows premium and coverage"
    - "T&C checkbox must be checked before submission is enabled"
  artifacts:
    - path: "client/src/components/review/ReviewSection.tsx"
      provides: "Reusable section card with title and edit button"
      exports: ["ReviewSection"]
    - path: "client/src/components/review/ReviewPage.tsx"
      provides: "Full review layout with all sections and quote sidebar"
      exports: ["ReviewPage"]
    - path: "client/src/components/review/index.ts"
      provides: "Barrel export for review components"
      exports: ["ReviewSection", "ReviewPage"]
  key_links:
    - from: "client/src/components/review/ReviewPage.tsx"
      to: "client/src/components/review/ReviewSection.tsx"
      via: "ReviewSection usage"
      pattern: "import.*ReviewSection"
    - from: "client/src/components/review/ReviewPage.tsx"
      to: "client/src/components/quote/QuoteBreakdown.tsx"
      via: "Quote display"
      pattern: "import.*QuoteBreakdown"
---

<objective>
Create review page components showing all KYC data with edit capabilities and quote sidebar.

Purpose: Allow users to verify all entered information before final submission.
Output: ReviewPage component with editable sections and sticky quote sidebar.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-init-flow/03-RESEARCH.md
@.planning/phases/03-init-flow/03-02-SUMMARY.md

# Components to reuse
@client/src/components/quote/QuoteBreakdown.tsx
@client/src/components/ui/card.tsx
@client/src/components/ui/checkbox.tsx
@client/src/components/ui/separator.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ReviewSection component</name>
  <files>client/src/components/review/ReviewSection.tsx</files>
  <action>
Create directory client/src/components/review/ and ReviewSection.tsx:

Props interface:
- title: string (section header)
- onEdit: () => void (callback when Edit clicked)
- children: React.ReactNode (section content)

Component structure:
- Card component wrapper
- CardHeader with flex row (justify-between):
  - CardTitle: {title}
  - Button variant="ghost" size="sm" with Pencil icon + "Edit" text, onClick={onEdit}
- CardContent: {children}

Use Pencil icon from lucide-react.
  </action>
  <verify>
    - File exists: `ls client/src/components/review/ReviewSection.tsx`
    - TypeScript compiles: `pnpm exec tsc --noEmit -p client`
  </verify>
  <done>
    - ReviewSection component created with edit button
    - Uses Card from shadcn/ui
    - Flexible children slot for section content
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ReviewPage component with quote sidebar</name>
  <files>
    client/src/components/review/ReviewPage.tsx
    client/src/components/review/index.ts
  </files>
  <action>
1. Create ReviewPage.tsx:

Props interface:
- formData: object with firstName, lastName, email, phone, address, pincode, city, state, panNumber, dateOfBirth, hasPED, conditions, otherDescription, nominees?
- quote: Quote type (from select-store types, or inline { price: { currency, value }, breakup? })
- selectedAddOns?: string[] (IDs of selected add-ons)
- onEdit: (section: "personal" | "identity" | "health" | "nominee") => void
- onSubmit: () => void
- termsAccepted: boolean
- onTermsChange: (accepted: boolean) => void
- isSubmitting?: boolean

Layout (responsive grid):
- Main content (lg:col-span-2):
  - Personal Information ReviewSection:
    - dl/dt/dd grid showing: Name (first + last), Email, Phone, Address, City/State/Pincode
    - onEdit={() => onEdit("personal")}

  - Identity Verification ReviewSection:
    - PAN (masked: show last 4 chars only, e.g., "XXXXXX1234")
    - Date of Birth
    - onEdit={() => onEdit("identity")}

  - Health Information ReviewSection:
    - Pre-existing conditions: "None" if hasPED false, otherwise list selected conditions
    - onEdit={() => onEdit("health")}

  - Nominee Details ReviewSection (only render if nominees?.length > 0):
    - For each nominee: Name, DOB, Relationship
    - onEdit={() => onEdit("nominee")}

  - Terms & Conditions Card:
    - Checkbox with label "I have read and agree to the Terms & Conditions and Privacy Policy"
    - checked={termsAccepted}, onCheckedChange={onTermsChange}

- Sidebar (lg:col-span-1):
  - Sticky Card (className="sticky top-4"):
    - CardHeader: "Quote Summary"
    - CardContent:
      - Import and use QuoteBreakdown component
      - Separator
      - Total Premium row (bold): "INR {quote.price.value}"
    - CardFooter:
      - Button size="lg" className="w-full" onClick={onSubmit} disabled={!termsAccepted || isSubmitting}
      - Text: "Proceed to Payment"
      - Show Loader2 spinner if isSubmitting

2. Create index.ts barrel export:
   export { ReviewSection } from "./ReviewSection";
   export { ReviewPage } from "./ReviewPage";
  </action>
  <verify>
    - Files exist: `ls client/src/components/review/`
    - QuoteBreakdown imported: `grep "QuoteBreakdown" client/src/components/review/ReviewPage.tsx`
    - Checkbox imported: `grep "Checkbox" client/src/components/review/ReviewPage.tsx`
    - TypeScript compiles: `pnpm exec tsc --noEmit -p client`
  </verify>
  <done>
    - ReviewPage shows all KYC data in organized sections
    - Each section has working Edit button
    - Quote sidebar displays premium breakdown
    - T&C checkbox gates submission
    - Responsive grid layout (stacked on mobile, side-by-side on desktop)
  </done>
</task>

</tasks>

<verification>
1. TypeScript compilation passes: `pnpm exec tsc --noEmit -p client`
2. ReviewSection has edit button: `grep "onEdit" client/src/components/review/ReviewSection.tsx`
3. ReviewPage uses Checkbox: `grep "Checkbox" client/src/components/review/ReviewPage.tsx`
4. Barrel exports both components: `grep -E "export.*Review" client/src/components/review/index.ts`
</verification>

<success_criteria>
- ReviewSection provides reusable section card with edit button
- ReviewPage displays all form data in 4 sections
- Quote sidebar is sticky on desktop
- T&C checkbox controls submit button enabled state
- PAN is masked for security
- All components compile without errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-init-flow/03-03-SUMMARY.md`
</output>
