---
phase: 02-form-infrastructure
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - client/src/components/forms/MultiStepForm.tsx
  - client/src/components/forms/FormStep.tsx
  - client/src/components/forms/StepProgress.tsx
  - client/src/components/forms/ResumePrompt.tsx
autonomous: true

must_haves:
  truths:
    - "MultiStepForm renders current step with slide animation"
    - "Navigation forward slides content left, backward slides right"
    - "StepProgress shows current step number and total steps"
    - "StepProgress visually distinguishes completed, current, and future steps"
    - "ResumePrompt offers choice to resume or start fresh"
  artifacts:
    - path: "client/src/components/forms/MultiStepForm.tsx"
      provides: "Multi-step form container with animations"
      exports: ["MultiStepForm", "MultiStepFormProps"]
    - path: "client/src/components/forms/FormStep.tsx"
      provides: "Individual step wrapper with title/description"
      exports: ["FormStep", "FormStepProps"]
    - path: "client/src/components/forms/StepProgress.tsx"
      provides: "Progress indicator component"
      exports: ["StepProgress", "StepProgressProps"]
    - path: "client/src/components/forms/ResumePrompt.tsx"
      provides: "Resume dialog component"
      exports: ["ResumePrompt", "ResumePromptProps"]
  key_links:
    - from: "client/src/components/forms/MultiStepForm.tsx"
      to: "motion/react"
      via: "AnimatePresence with direction-aware variants"
      pattern: "AnimatePresence.*mode=\"wait\""
    - from: "client/src/components/forms/ResumePrompt.tsx"
      to: "client/src/components/ui/dialog.tsx"
      via: "Dialog component"
      pattern: "import.*Dialog.*from"
---

<objective>
Create the multi-step form container components with Typeform-style slide animations and progress tracking.

Purpose: Build the visual infrastructure for multi-step forms â€” the container that manages step transitions, the progress indicator, and the resume prompt dialog.

Output: Four React components that can be composed to create any multi-step form experience.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-form-infrastructure/CONTEXT.md
@.planning/phases/02-form-infrastructure/02-RESEARCH.md
@client/src/components/RotatingText.tsx
@client/src/components/ui/dialog.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MultiStepForm and FormStep components</name>
  <files>
    client/src/components/forms/MultiStepForm.tsx
    client/src/components/forms/FormStep.tsx
  </files>
  <action>
**Create forms directory and MultiStepForm component:**

File: `client/src/components/forms/MultiStepForm.tsx`

Implement a generic multi-step form container:

```typescript
import { AnimatePresence, motion } from "motion/react";
import { useState, type ReactNode } from "react";

type Direction = "forward" | "back";

const slideVariants = {
  initial: (direction: Direction) => ({
    x: direction === "forward" ? "100%" : "-100%",
    opacity: 0,
  }),
  animate: {
    x: "0%",
    opacity: 1,
  },
  exit: (direction: Direction) => ({
    x: direction === "forward" ? "-100%" : "100%",
    opacity: 0,
  }),
};

const slideTransition = {
  type: "spring",
  damping: 25,
  stiffness: 300,
  mass: 0.8,
};

export interface MultiStepFormProps {
  children: ReactNode[];  // Array of step content (FormStep components)
  currentStep: number;
  className?: string;
}

export function MultiStepForm({ children, currentStep, className }: MultiStepFormProps) {
  const [direction, setDirection] = useState<Direction>("forward");
  const [prevStep, setPrevStep] = useState(currentStep);

  // Track direction based on step changes
  if (currentStep !== prevStep) {
    setDirection(currentStep > prevStep ? "forward" : "back");
    setPrevStep(currentStep);
  }

  const steps = Array.isArray(children) ? children : [children];
  const currentChild = steps[currentStep];

  return (
    <div className={cn("overflow-hidden relative", className)}>
      <AnimatePresence mode="wait" custom={direction}>
        <motion.div
          key={currentStep}
          custom={direction}
          variants={slideVariants}
          initial="initial"
          animate="animate"
          exit="exit"
          transition={slideTransition}
        >
          {currentChild}
        </motion.div>
      </AnimatePresence>
    </div>
  );
}
```

Import `cn` from `@/lib/utils`.

**Create FormStep component:**

File: `client/src/components/forms/FormStep.tsx`

Individual step wrapper with title and description (per CONTEXT.md: "Each step has title + description at top"):

```typescript
import { type ReactNode } from "react";

export interface FormStepProps {
  title: string;
  description?: string;
  children: ReactNode;
}

export function FormStep({ title, description, children }: FormStepProps) {
  return (
    <div className="space-y-6">
      <div className="space-y-2">
        <h2 className="text-xl font-semibold tracking-tight">{title}</h2>
        {description && (
          <p className="text-sm text-muted-foreground">{description}</p>
        )}
      </div>
      <div>{children}</div>
    </div>
  );
}
```
  </action>
  <verify>
1. Files exist at correct paths
2. TypeScript compiles: `cd client && npx tsc --noEmit`
3. AnimatePresence and motion are properly imported from "motion/react"
  </verify>
  <done>
- MultiStepForm renders children based on currentStep index
- Slide animation moves left on forward, right on back
- FormStep renders title, optional description, and children
  </done>
</task>

<task type="auto">
  <name>Task 2: Create StepProgress and ResumePrompt components</name>
  <files>
    client/src/components/forms/StepProgress.tsx
    client/src/components/forms/ResumePrompt.tsx
  </files>
  <action>
**Create StepProgress component:**

File: `client/src/components/forms/StepProgress.tsx`

Per CONTEXT.md, progress indicator style is Claude's discretion. Implementing numbered circles (clearer for 3-5 steps per RESEARCH.md recommendation):

```typescript
import { cn } from "@/lib/utils";
import { Check } from "lucide-react";

export interface StepProgressProps {
  currentStep: number;  // 0-indexed
  totalSteps: number;
  stepTitles?: string[];  // Optional labels for each step
  className?: string;
}

export function StepProgress({
  currentStep,
  totalSteps,
  stepTitles,
  className,
}: StepProgressProps) {
  return (
    <div
      className={cn("flex items-center justify-between", className)}
      role="progressbar"
      aria-valuenow={currentStep + 1}
      aria-valuemin={1}
      aria-valuemax={totalSteps}
      aria-label={`Step ${currentStep + 1} of ${totalSteps}`}
    >
      {Array.from({ length: totalSteps }).map((_, index) => {
        const isCompleted = index < currentStep;
        const isCurrent = index === currentStep;
        const isFuture = index > currentStep;

        return (
          <div key={index} className="flex items-center">
            {/* Step circle */}
            <div
              className={cn(
                "w-8 h-8 rounded-full flex items-center justify-center border-2 font-semibold text-sm transition-colors",
                isCompleted && "bg-primary border-primary text-primary-foreground",
                isCurrent && "border-primary text-primary bg-primary/10",
                isFuture && "border-muted-foreground/30 text-muted-foreground"
              )}
            >
              {isCompleted ? (
                <Check className="w-4 h-4" />
              ) : (
                index + 1
              )}
            </div>

            {/* Connector line (except for last step) */}
            {index < totalSteps - 1 && (
              <div
                className={cn(
                  "h-0.5 w-8 sm:w-12 mx-1 sm:mx-2 transition-colors",
                  index < currentStep ? "bg-primary" : "bg-muted"
                )}
              />
            )}
          </div>
        );
      })}
    </div>
  );
}
```

**Create ResumePrompt component:**

File: `client/src/components/forms/ResumePrompt.tsx`

Per CONTEXT.md: "On return to partial form: show prompt 'Resume where you left off?'" and "Resume prompt should be dismissible (user can choose to start fresh)":

```typescript
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";

export interface ResumePromptProps {
  open: boolean;
  onResume: () => void;
  onStartFresh: () => void;
}

export function ResumePrompt({ open, onResume, onStartFresh }: ResumePromptProps) {
  return (
    <Dialog open={open} onOpenChange={(isOpen) => !isOpen && onStartFresh()}>
      <DialogContent className="sm:max-w-md">
        <DialogHeader>
          <DialogTitle>Resume where you left off?</DialogTitle>
          <DialogDescription>
            We found your previously entered information. Would you like to continue
            from where you stopped, or start fresh?
          </DialogDescription>
        </DialogHeader>
        <DialogFooter className="flex-col sm:flex-row gap-2">
          <Button
            variant="outline"
            onClick={onStartFresh}
            className="w-full sm:w-auto"
          >
            Start Fresh
          </Button>
          <Button
            onClick={onResume}
            className="w-full sm:w-auto"
          >
            Resume
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}
```
  </action>
  <verify>
1. Files exist at correct paths
2. TypeScript compiles: `cd client && npx tsc --noEmit`
3. Imports resolve correctly (Dialog from ui, lucide-react icons)
  </verify>
  <done>
- StepProgress shows numbered circles with check marks for completed steps
- StepProgress has proper ARIA attributes for accessibility
- ResumePrompt presents Resume and Start Fresh options
- Closing ResumePrompt triggers onStartFresh (dismissible behavior)
  </done>
</task>

</tasks>

<verification>
1. `cd client && npx tsc --noEmit` passes
2. All four component files exist in client/src/components/forms/
3. MultiStepForm uses AnimatePresence with direction-aware variants
4. StepProgress has role="progressbar" with aria-valuenow
5. ResumePrompt imports Dialog from @/components/ui/dialog
</verification>

<success_criteria>
- MultiStepForm component renders with slide animations (left on forward, right on back)
- FormStep component wraps step content with title and description
- StepProgress shows current step with visual distinction for completed/current/future
- ResumePrompt offers Resume and Start Fresh buttons
- All components TypeScript-safe with proper prop types exported
</success_criteria>

<output>
After completion, create `.planning/phases/02-form-infrastructure/02-02-SUMMARY.md`
</output>
